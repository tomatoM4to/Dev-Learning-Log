# 10장: 버퍼 오버플로우
* 가장 흔히 발견돼는 공격중 하나
* 부주의한 프로그래밍 실수에 의해 발생돼는 경우가 많다.

***

# Buffer Overflow
* 매우 일반적인 공격 매커니즘으로, 1988년 모리스 인터넷 웜(Morris Internet Worm)이란 악성 소프트웨어에 의해 처음 사용된 매커니즘이다.
    * Morris Internet Worm: Morris라는 학생이 만든 유닉스 기반 운영체제를 공격하는 악성코드
* CERT나 SANS같은 보안 관련 기관에서 보안 관련 경구 리스트에 많이 포함되어 있다.
* 오래된 기법이라, 예방기법이 비교적 잘 밝혀져 있고, 문서화되어 있다.
* 그러나, 아직도 보안 전문가들의 중요한 관심 사항중 하나이다.
    * 기존 운영체제와 애플리케이션들에 있는 버그 코드가 아직도 수정돼지 않은경우
    * 프로그래머의 **부주의한 프로그래밍 습관** 의 지속 등

## 버퍼 오버플로우 공격의 역사 요약
1. **1988:** Morris Internet Worm은 공격 방법 중 하나인 fingerd 프로그램의 버퍼 오버플로우 취약점을 사용
    * fingerd: 원격 으로 로그인 돼어있는 사용자들의 정보를 알려주는 프로그램
2. **1995:** Thomas Lopatic는 NCSA http 1.3에서 버퍼 오버플로우를 발견하고, Bugtraq 메일링 리스트에 발표
3. **1996:** Aleph One는 잡지 Phrack에서 "Smashing the Stack for Fun and Profit"을 발표하면서 스택 기반의 버퍼 오버플로우 취약점을 이용한 방법을 소개
4. **2001:** Code Red Worm은 "Microsft IIS 5.0"의 버퍼 오버플로우를 이용
5. **2003:** Slammer Worm은 "Microsoft SQL Server 2000"의 버퍼 오버플로우를 이용
6. **2004:** Sasser Worm은 "Microsoft Windows 2000/XP Local Security Authority Subsystem Service"(LSASS)의 버퍼 오버플로우를 이용

***

# Stack Overflow
* 버퍼 어보플로우 공격중 가장 고전적인 공격
* 스택을 대상으로 한 오버플로우 공격

## Buffer overflow | Buffer overrun | Buffer overwrite 의 정의
* **NIST:** 버퍼 또는 데이터 저장 영역에 **할당된 용량보다 더 많은 자료를 입력** 하여 **다른 정보를 변경할 수** 있는 인터페이스에서의 조건(취약점). 공격자는 이런 조건(취약점)을 이용하여 **시스템을 손상** 시키거나 시스템을 제어할 수 있는 **쉘코드** 를 삽입한다.
    * 버퍼 또는 데이터 저장 영역에 할당된 용량이라 하면, 프로세스의 스택과 힙 영역을 예로 들수 있다.
    * ex) char[20]; 공간에 30개의 문자를 저장

## 버퍼 오버플로우의 기초
* 하나의 프로세스가 **고정된 크기의 버퍼 용량**을 초과하는 데이터를 저장하려 할 때의 **프로그래밍 에러**, 하지만 에러임에도 프로세스가 계속 실행되며, 인접메모리 공간을 덮어쓰며 내용을 변경하는것
    * 인접 메모리 공간: 프로그램의 다른 변수, 복귀주소(함수 반환 주소), 호출 함수의 실행 환경을 저장하고 있는 스택 프레임의 포인터 같은 정보 **프로그램 제어 데이터** 들
* 버퍼 취급돼는 데이터 영역은 스택이나 힙 또는 프로세스의 데이터 섹션 들이 있다.





## 버퍼 오버플로우 공격
* 공격자가 버퍼 오버플로우를 이용하려면 다음과 같은 작업이 필요하다.
    1.


